"use strict";var P=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var $=Object.getOwnPropertyNames;var j=Object.prototype.hasOwnProperty;var C=(s,o)=>{for(var i in o)P(s,i,{get:o[i],enumerable:!0})},U=(s,o,i,c)=>{if(o&&typeof o=="object"||typeof o=="function")for(let n of $(o))!j.call(s,n)&&n!==i&&P(s,n,{get:()=>o[n],enumerable:!(c=I(o,n))||c.enumerable});return s};var M=s=>U(P({},"__esModule",{value:!0}),s);var B={};C(B,{createFormStore:()=>z,inputDateHelpers:()=>T,useFormStore:()=>q});module.exports=M(B);function R(s,o){let i="";switch(o){case"date":i=s.toISOString().slice(0,10);break;case"time":i=s.toTimeString().slice(0,8);break;case"datetime-local":i=s.toISOString().slice(0,16),i=i.replace("T"," ");break;case"week":let c=s.getFullYear(),n=H(s);i=`${c}-W${n.toString().length<2?"0"+n.toString():n.toString()}`;break;case"month":i=s.toISOString().slice(0,7);break;default:break}return i}function Z(s,o){let i;switch(o){case"date":i=new Date(s);break;case"time":let[c,n,u]=s.toString().split(":");i=new Date,i.setHours(Number(c)),i.setMinutes(Number(n)),i.setSeconds(Number(u));break;case"datetime-local":i=new Date(s.toString().replace(" ","T"));break;case"week":let[F,g]=s.toString().split("-W"),V=Number(F),D=Number(g);i=O(V,D);break;case"month":i=new Date(`${s}-01`);break;default:i=new Date;break}return i}function H(s){let o=new Date(s.getFullYear(),0,1),i=(s.valueOf()-o.valueOf())/(1e3*60*60*24);return Math.floor(i/7)+1}function O(s,o){let i=new Date(s,0,1),c=(8-i.getDay())%7,n=new Date(i);n.setDate(i.getDate()+c);let u=(o-1)*7,F=new Date(n);return F.setDate(n.getDate()+u),F}var K={formatDate:R,parseDate:Z,getWeekNumber:H,getFirstDateOfWeek:O},T=K;var h=require("zustand"),W=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{let o=Math.random()*16|0;return(s==="x"?o:o&3|8).toString(16)}),Y=s=>s instanceof Object&&"parseAsync"in s&&typeof s.parseAsync=="function",_=s=>s instanceof Object&&"errors"in s,z=({isUpdatingFieldsValueOnError:s=!0,trackValidationHistory:o=!1,valuesFromFieldsToStore:i,valuesFromStoreToFields:c,validationHandler:n,...u})=>{if(!u.initValues||typeof u.initValues!="object")throw new Error("");let F=typeof u.baseId=="boolean"?W():u.baseId?`${u.baseId}-`:"",g={},V={fieldsNames:Object.keys(u.initValues),formId:`${F}form`},D=0,b={},w,A,k={submit:!0},N=!1,E;for(let l of V.fieldsNames){let v=n?.[l];if(A={handler:v?Y(v)?e=>v.parse(e):v:void 0,failedAttempts:0,passedAttempts:0,events:{blur:{failedAttempts:0,passedAttempts:0,isActive:!1},change:{failedAttempts:0,passedAttempts:0,isActive:!1},mount:{failedAttempts:0,passedAttempts:0,isActive:!1},submit:{failedAttempts:0,passedAttempts:0,isActive:!1}}},w=u.initValues[l],u.validationEvents&&(N=!0,k={...k,...u.validationEvents}),b[l]={value:w,isUpdatingValueOnError:s,valueFromFieldToStore:i?.[l]?i[l]:void 0,valueFromStoreToField:c?.[l]?c[l]:void 0},N)for(E in k)A.events[E].isActive=!!typeof k[E];b[l]={...b[l],errors:null,isDirty:!1,metadata:{id:`${F}field-${String(l)}`,name:l,initialValue:b[l].value},validation:A}}return(0,h.createStore)((l,v)=>({fields:b,errors:g,metadata:V,submitCounter:D,isTrackingValidationHistory:o,validations:{history:[]},utils:{handleOnInputChange:(e,a)=>{let r=v(),t=r.utils.handleFieldValidation({name:e,value:a,validationEvent:"change"});r.utils.setFieldValue(e,t)},errorFormatter:e=>_(e)?e.format()._errors:e instanceof Error?[e.message]:["Something went wrong!"],reInitFieldsValues:()=>l(e=>{let a=e.metadata.fieldsNames,r=e.fields,t;for(t of a)r[t]={...r[t],value:r[t].metadata.initialValue};return{fields:r}}),setFieldValue:(e,a)=>l(r=>({fields:{...r.fields,[e]:{...r.fields[e],value:typeof a=="function"?a(r.fields[e].value):a}}})),setFieldErrors:e=>l(a=>{let r=!!e.errors,t=a.fields[e.name];return t={...t,isDirty:r,errors:e.errors,validation:{...t.validation,events:{...t.validation.events,[e.validationEvent]:{...t.validation.events[e.validationEvent],failedAttempts:r?t.validation.events[e.validationEvent].failedAttempts:t.validation.events[e.validationEvent].failedAttempts+1,passedAttempts:r?t.validation.events[e.validationEvent].passedAttempts:t.validation.events[e.validationEvent].passedAttempts+1}}}},{fields:{...a.fields,[e.name]:t},errors:g}}),createValidationHistoryRecord:({fields:e,validationEvent:a,validationEventPhase:r,validationEventState:t})=>{let p=[];r==="start"&&p.push(`Starting the validation for fields: [${Object.keys(e).join(", ")}]`),r==="end"&&p.push(`Ending the validation for fields: [${Object.keys(e).join(", ")}]`),p.push(`Validation ${t[0].toUpperCase()+t.slice(1)}!`),e.forEach(m=>{p.push(`Field: ${String(m.metadata.name)}, Failed Attempts: ${m.validation.events[a].failedAttempts}, Passed Attempt: ${m.validation.events[a].passedAttempts}`)})},handleFieldValidation:({name:e,validationEvent:a,value:r})=>{let t=v();if(!t.fields[e].validation.events[a].isActive)return r;let p=t.fields[e].validation.handler;if(!p)return r;let m=t.fields[e].valueFromFieldToStore,d=m?m(r):r,S=t.fields[e].isUpdatingValueOnError,f=y=>(t.utils.setFieldErrors({name:e,errors:t.utils.errorFormatter(y,a),validationEvent:a}),S?d:t.fields[e].value);if(t.isTrackingValidationHistory)try{t.utils.createValidationHistoryRecord({fields:[t.fields[e]],validationEvent:a,validationEventPhase:"start",validationEventState:"processing"}),d=p(d,a),t.fields[e].isDirty&&t.utils.setFieldErrors({name:e,errors:null,validationEvent:a}),t.utils.createValidationHistoryRecord({fields:[t.fields[e]],validationEvent:a,validationEventPhase:"end",validationEventState:"passed"})}catch(y){d=f(y),t.utils.createValidationHistoryRecord({fields:[t.fields[e]],validationEvent:a,validationEventPhase:"end",validationEventState:"failed"})}else try{d=p(d,a),t.fields[e].isDirty&&t.utils.setFieldErrors({name:e,errors:null,validationEvent:a})}catch(y){d=f(y)}return d},handlePreSubmit:e=>a=>{if(a.preventDefault(),!e)return;let r=v(),t=r.fields,p={},m={},d={},S=!1,f;for(f in t)try{let x=t[f].validation.handler;t[f].validation.events.submit.isActive&&typeof x=="function"&&(m[f]=x(t[f].value,"submit")),p[f]=t[f].value,d[f]={name:f,errors:null,validationEvent:"submit"}}catch(x){d[f]={name:f,errors:r.utils.errorFormatter(x,"submit"),validationEvent:"submit"},S=!0}let y;for(y in d)r.utils.setFieldErrors(d[y]);S||e(a,{values:p,validatedValues:m,hasError:S,errors:d})}}}))},q=(s,o)=>(0,h.useStore)(s,o);0&&(module.exports={createFormStore,inputDateHelpers,useFormStore});
//# sourceMappingURL=index.js.map