"use strict";var P=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var $=Object.getOwnPropertyNames;var C=Object.prototype.hasOwnProperty;var j=(s,n)=>{for(var a in n)P(s,a,{get:n[a],enumerable:!0})},U=(s,n,a,u)=>{if(n&&typeof n=="object"||typeof n=="function")for(let o of $(n))!C.call(s,o)&&o!==a&&P(s,o,{get:()=>n[o],enumerable:!(u=I(n,o))||u.enumerable});return s};var M=s=>U(P({},"__esModule",{value:!0}),s);var q={};j(q,{createFormStore:()=>_,inputDateHelpers:()=>T,useFormStore:()=>z});module.exports=M(q);function Z(s,n){let a="";switch(n){case"date":a=s.toISOString().slice(0,10);break;case"time":a=s.toTimeString().slice(0,8);break;case"datetime-local":a=s.toISOString().slice(0,16),a=a.replace("T"," ");break;case"week":let u=s.getFullYear(),o=w(s);a=`${u}-W${o.toString().length<2?"0"+o.toString():o.toString()}`;break;case"month":a=s.toISOString().slice(0,7);break;default:break}return a}function R(s,n){let a;switch(n){case"date":a=new Date(s);break;case"time":let[u,o,c]=s.toString().split(":");a=new Date,a.setHours(Number(u)),a.setMinutes(Number(o)),a.setSeconds(Number(c));break;case"datetime-local":a=new Date(s.toString().replace(" ","T"));break;case"week":let[y,x]=s.toString().split("-W"),g=Number(y),k=Number(x);a=N(g,k);break;case"month":a=new Date(`${s}-01`);break;default:a=new Date;break}return a}function w(s){let n=new Date(s.getFullYear(),0,1),a=(s.valueOf()-n.valueOf())/(1e3*60*60*24);return Math.floor(a/7)+1}function N(s,n){let a=new Date(s,0,1),u=(8-a.getDay())%7,o=new Date(a);o.setDate(a.getDate()+u);let c=(n-1)*7,y=new Date(o);return y.setDate(o.getDate()+c),y}var K={formatDate:Z,parseDate:R,getWeekNumber:w,getFirstDateOfWeek:N},T=K;var h=require("zustand"),W=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{let n=Math.random()*16|0;return(s==="x"?n:n&3|8).toString(16)}),Y=s=>s instanceof Object&&"parseAsync"in s&&typeof s.parseAsync=="function",G=s=>s instanceof Object&&"errors"in s,_=({isUpdatingFieldsValueOnError:s=!0,trackValidationHistory:n=!1,valuesFromFieldsToStore:a,valuesFromStoreToFields:u,validationHandler:o,...c})=>{let y=typeof c.baseId=="boolean"?W():c.baseId?`${c.baseId}-`:"",x={},g={fieldsNames:Object.keys(c.initValues),formId:`${y}form`},k=0,V={},E,A,S={submit:!0},H=!1,D;for(let l of g.fieldsNames){let F=o?.[l];if(A={handler:Y(F)?e=>F.parse(e):F,failedAttempts:0,passedAttempts:0,events:{blur:{failedAttempts:0,passedAttempts:0,isActive:!1},change:{failedAttempts:0,passedAttempts:0,isActive:!1},mount:{failedAttempts:0,passedAttempts:0,isActive:!1},submit:{failedAttempts:0,passedAttempts:0,isActive:!1}}},E=c.initValues[l],c.validationEvents&&(H=!0,S={...S,...c.validationEvents}),V[l]={value:E,isUpdatingValueOnError:s,valueFromFieldToStore:a?.[l]?a[l]:void 0,valueFromStoreToField:u?.[l]?u[l]:void 0},H)for(D in S)A.events[D].isActive=!!typeof S[D];V[l]={...V[l],errors:null,isDirty:!1,metadata:{id:`${y}field-${String(l)}`,name:l,initialValue:V[l].value},validation:A}}return(0,h.createStore)((l,F)=>({fields:V,errors:x,metadata:g,submitCounter:k,isTrackingValidationHistory:n,validations:{handler:{},history:[]},utils:{handleOnInputChange:(e,i)=>{let r=F(),t=r.utils.handleFieldValidation({name:e,value:i,validationEvent:"change"});r.utils.setFieldValue(e,t)},errorFormatter:e=>G(e)?e.format()._errors:e instanceof Error?[e.message]:["Something went wrong!"],reInitFieldsValues:()=>l(e=>{let i=e.metadata.fieldsNames,r=e.fields,t;for(t of i)r[t]={...r[t],value:r[t].metadata.initialValue};return{fields:r}}),setFieldValue:(e,i)=>l(r=>({fields:{...r.fields,[e]:{...r.fields[e],value:typeof i=="function"?i(r.fields[e].value):i}}})),setFieldErrors:e=>l(i=>{let r=!!e.errors,t=i.fields[e.name];return t={...t,isDirty:r,errors:e.errors,validation:{...t.validation,events:{...t.validation.events,[e.validationEvent]:{...t.validation.events[e.validationEvent],failedAttempts:r?t.validation.events[e.validationEvent].failedAttempts:t.validation.events[e.validationEvent].failedAttempts+1,passedAttempts:r?t.validation.events[e.validationEvent].passedAttempts:t.validation.events[e.validationEvent].passedAttempts+1}}}},{fields:{...i.fields,[e.name]:t},errors:x}}),createValidationHistoryRecord:({fields:e,validationEvent:i,validationEventPhase:r,validationEventState:t})=>{let p=[];r==="start"&&p.push(`Starting the validation for fields: [${Object.keys(e).join(", ")}]`),r==="end"&&p.push(`Ending the validation for fields: [${Object.keys(e).join(", ")}]`),p.push(`Validation ${t[0].toUpperCase()+t.slice(1)}!`),e.forEach(m=>{p.push(`Field: ${String(m.metadata.name)}, Failed Attempts: ${m.validation.events[i].failedAttempts}, Passed Attempt: ${m.validation.events[i].passedAttempts}`)})},handleFieldValidation:({name:e,validationEvent:i,value:r})=>{let t=F();if(!t.fields[e].validation.events[i].isActive)return r;let p=t.fields[e].validation.handler||t.validations.handler[e];if(!p)return r;let m=t.fields[e].valueFromFieldToStore,f=m?m(r):r,b=t.fields[e].isUpdatingValueOnError,d=v=>(t.utils.setFieldErrors({name:e,errors:t.utils.errorFormatter(v,i),validationEvent:i}),b?f:t.fields[e].value);if(t.isTrackingValidationHistory)try{t.utils.createValidationHistoryRecord({fields:[t.fields[e]],validationEvent:i,validationEventPhase:"start",validationEventState:"processing"}),f=p(f,i),t.fields[e].isDirty&&t.utils.setFieldErrors({name:e,errors:null,validationEvent:i}),t.utils.createValidationHistoryRecord({fields:[t.fields[e]],validationEvent:i,validationEventPhase:"end",validationEventState:"passed"})}catch(v){f=d(v),t.utils.createValidationHistoryRecord({fields:[t.fields[e]],validationEvent:i,validationEventPhase:"end",validationEventState:"failed"})}else try{f=p(f,i),t.fields[e].isDirty&&t.utils.setFieldErrors({name:e,errors:null,validationEvent:i})}catch(v){f=d(v)}return f},handlePreSubmit:e=>i=>{if(i.preventDefault(),!e)return;let r=F(),t=r.fields,p={},m={},f={},b=!1,d;for(d in t)try{t[d].validation.events.submit.isActive&&t[d].validation.handler&&(m[d]=t[d].validation.handler(t[d].value,"submit")),p[d]=t[d].value,f[d]={name:d,errors:null,validationEvent:"submit"}}catch(O){f[d]={name:d,errors:r.utils.errorFormatter(O,"submit"),validationEvent:"submit"},b=!0}let v;for(v in f)r.utils.setFieldErrors(f[v]);b||e(i,{values:p,validatedValues:m,hasError:b,errors:f})}}}))},z=(s,n)=>(0,h.useStore)(s,n);0&&(module.exports={createFormStore,inputDateHelpers,useFormStore});
//# sourceMappingURL=index.js.map