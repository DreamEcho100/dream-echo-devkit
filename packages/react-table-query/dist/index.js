'use strict';

var zustand = require('zustand');
var react = require('react');
var jsxRuntime = require('react/jsx-runtime');
var reactTable = require('@tanstack/react-table');

var B=({classNames:e={},pageViewMode:a="PAGING",canMultiRowSelect:n=!1,tableAutoToFixedOnLoad:o=!1,columnVisibility:s={},baseId:i="",queryInput:d})=>zustand.createStore(u=>({table:null,baseId:i,queryInput:d,classNames:e,pageViewMode:a,canMultiRowSelect:n,tableAutoToFixedOnLoad:o,columnFilters:[],rowSelection:{},columnVisibility:s,sorting:[],setPagination:t=>u(r=>{let g=typeof t=="function"?t({pageIndex:r.queryInput.offset||0,pageSize:r.queryInput.limit||0}):{pageIndex:t.pageIndex||r.queryInput.offset,pageSize:t.pageSize||r.queryInput.limit};return {queryInput:{...r.queryInput,limit:g.pageSize,offset:g.pageIndex}}}),setQueryInput:t=>u(r=>({queryInput:typeof t=="function"?t(r.queryInput):t})),setRowSelection:t=>u(r=>({rowSelection:typeof t=="function"?t(r.rowSelection):t})),setColumnFilters:t=>u(r=>({columnFilters:typeof t=="function"?t(r.columnFilters):t})),setColumnVisibility:t=>u(r=>({columnVisibility:typeof t=="function"?t(r.columnVisibility):t})),setSorting:t=>u(r=>({sorting:typeof t=="function"?t(r.sorting):t}))})),ae=e=>{let a=react.useId(),n=react.useRef(B({...e,baseId:e.baseId||a}));return react.useMemo(()=>{(n.current.getState().queryInput.limit!==e.queryInput.limit||n.current.getState().baseId!==e.baseId)&&n.current.setState(()=>({limit:e.queryInput.limit,baseId:e.baseId}));},[e.baseId,e.queryInput.limit]),n.current};var f=(...e)=>{let a="",n;for(n of e)typeof n=="string"&&(a+=n+" ");return a.trimEnd()},C=e=>{let a=zustand.useStore(e.store,u=>u.pageViewMode),n=zustand.useStore(e.store,u=>u.queryInput.offset||0),o=react.useMemo(()=>[],[]),s=react.useMemo(()=>a==="INFINITE_SCROLL"?(e.infiniteQuery?.data?.pages||o).map(u=>u.items).flat(1):e.infiniteQuery?.data?.pages?.[n]?.items||o,[n,e.infiniteQuery.data?.pages,a,o]),i=react.useMemo(()=>({offset:n,limit:e.infiniteQuery?.data?.pages.length||0}),[n,e.infiniteQuery?.data?.pages.length]);return react.useMemo(()=>({currentPage:s,pagination:{pageSize:i.limit,pageIndex:i.offset}}),[s,i.limit,i.offset])};var F=({infiniteQuery:e,store:a,classNames:n={container:"",loadMoreButton:""}})=>{let o=zustand.useStore(a,t=>t.queryInput.offset||0),s=zustand.useStore(a,t=>t),{isLastPageEmpty:i,isInBeforeLastPage:d}=react.useMemo(()=>{let t=e?.data?.pages?.[e.data.pages.length-1]?.items.length===0,r=o===0,g=o+1===e?.data?.pages?.length,T=typeof e?.data?.pages?.length=="number"&&e.data.pages.length!==0&&o+1===e.data.pages.length-1,l=e?.data?.pages?.length||0;return t&&l!==0&&l--,{isLastPageEmpty:t,isInBeforeLastPage:T,isInLastPage:g,isInFirstPage:r,pagesLength:l}},[o,e?.data?.pages]),u=react.useMemo(()=>!e.hasNextPage&&o+1===e.data?.pages.length||e.isFetching||d&&i,[o,e.data?.pages.length,e.hasNextPage,e.isFetching,d,i]);return e.hasNextPage?jsxRuntime.jsx("div",{className:f(n?.container),children:jsxRuntime.jsx("button",{title:u?"There is no more next page":"Next page",disabled:u,onClick:async()=>{u||await e.fetchNextPage().then(t=>{if(t.data&&Array.isArray(t.data?.pages)){let r=t.data.pages[t.data.pages.length-1];if(!r||d&&r.items.length===0)return}s.setQueryInput(r=>({...r,offset:(r.offset||0)+1}));});},className:f(n?.loadMoreButton),children:"load more"})}):jsxRuntime.jsx(jsxRuntime.Fragment,{})},q=F;var H=({store:e,...a})=>{let n=zustand.useStore(e,o=>o.classNames?.table);return jsxRuntime.jsx("table",{...a,className:n})},w=e=>jsxRuntime.jsx("thead",{...e}),L=e=>jsxRuntime.jsx("tbody",{...e});var y=e=>jsxRuntime.jsx("tr",{...e}),Q=e=>jsxRuntime.jsx("th",{...e}),h=e=>jsxRuntime.jsx("td",{...e}),S=({indeterminate:e,store:a,tContainerType:n,...o})=>{let s=zustand.useStore(a,d=>n==="thead"?d.classNames?.thead?.th?.selectCheckBoxContainer:d.classNames?.tbody?.td?.selectCheckBoxContainer),i=react.useRef(null);return react.useEffect(()=>{i.current&&typeof e=="boolean"&&(i.current.indeterminate=!o.checked&&e);},[e,o.checked]),jsxRuntime.jsx("div",{className:s?._,children:jsxRuntime.jsx("input",{type:"checkbox",ref:i,className:s?.checkbox,...o})})};var Z=({table:e,store:a})=>{let n=zustand.useStore(a,o=>o.classNames.thead);return jsxRuntime.jsx(w,{className:n?._,children:e.getHeaderGroups().map(o=>jsxRuntime.jsx(y,{className:n?.tr,children:o.headers.map(s=>jsxRuntime.jsx(Q,{"data-id":s.id,className:n?.th?._,"data-select-th":s.id==="select"?!0:void 0,children:s.isPlaceholder?null:reactTable.flexRender(s.column.columnDef.header,s.getContext())},s.id))},o.id))})},$=({table:e,columnsLength:a,store:n})=>{let o=zustand.useStore(n,s=>s.classNames.tbody);return jsxRuntime.jsx(L,{className:o?._,"data-state":e.getRowModel().rows?.length>0?void 0:"empty",children:e.getRowModel().rows?.length>0?e.getRowModel().rows.map(s=>jsxRuntime.jsx(y,{"data-state":s.getIsSelected()&&"selected",className:o?.tr,children:s.getVisibleCells().map(i=>jsxRuntime.jsx(h,{className:o?.td?._,"data-select-td":i.column.id==="select"?!0:void 0,children:reactTable.flexRender(i.column.columnDef.cell,i.getContext())},i.id))},s.id)):jsxRuntime.jsx(y,{"data-state":"empty",children:jsxRuntime.jsx(h,{colSpan:a,"data-state":"empty",className:"h-24 text-center",children:"No results."})})})},j=({columns:e,store:a,infiniteQuery:n})=>{let o=zustand.useStore(a,l=>l),s=zustand.useStore(a,l=>l.canMultiRowSelect),i=react.useMemo(()=>[{id:"select",header:({table:l})=>jsxRuntime.jsx(S,{checked:l.getIsAllRowsSelected(),indeterminate:l.getIsSomeRowsSelected(),onChange:l.getToggleAllRowsSelectedSchema(),tContainerType:"thead",store:a}),cell:({row:l})=>jsxRuntime.jsx(S,{checked:l.getIsSelected(),indeterminate:l.getIsSomeSelected(),onChange:l.getToggleSelectedSchema(),tContainerType:"tbody",store:a}),enableSorting:!1,enableHiding:s},...e],[s,e,a]),d=zustand.useStore(a,l=>l.sorting),u=zustand.useStore(a,l=>l.columnFilters),t=zustand.useStore(a,l=>l.columnVisibility),r=zustand.useStore(a,l=>l.rowSelection),g=C({infiniteQuery:n,store:a}),T=reactTable.useReactTable({data:g.currentPage,columns:i,onSortingChange:o.setSorting,onColumnFiltersChange:o.setColumnFilters,getCoreRowModel:reactTable.getCoreRowModel(),getPaginationRowModel:reactTable.getPaginationRowModel(),getSortedRowModel:reactTable.getSortedRowModel(),getFilteredRowModel:reactTable.getFilteredRowModel(),onPaginationChange:o.setPagination,onColumnVisibilityChange:o.setColumnVisibility,onRowSelectionChange:o.setRowSelection,manualPagination:!0,manualFiltering:!0,manualSorting:!0,state:{pagination:g.pagination,sorting:d,columnFilters:u,columnVisibility:t,rowSelection:r}});return react.useEffect(()=>a.setState({table:T}),[a,T]),jsxRuntime.jsxs(H,{store:a,children:[jsxRuntime.jsx(Z,{table:T,store:a}),jsxRuntime.jsx($,{table:T,columnsLength:e.length,store:a})]})},V=j;

exports.QueryTable = V;
exports.TableLoadMore = q;
exports.handleCreateTableStore = B;
exports.useCreateTableStore = ae;
//# sourceMappingURL=out.js.map
//# sourceMappingURL=index.js.map